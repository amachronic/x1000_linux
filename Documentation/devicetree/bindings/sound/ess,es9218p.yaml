# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/sound/ess,es9218p.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: ESS ES9218P audio codec

maintainers:
  - Aidan MacDonald <aidanmacdonald.0x0@gmail.com>

allOf:
  - $ref: dai-common.yaml#

properties:
  compatible:
    const: ess,es9218p

  reg:
    maxItems: 1

  "#sound-dai-cells":
    const: 0

  avdd-supply:
    description:
      Digital core power supply.

  vcca-supply:
    description:
      Oscillator and DAC power supply.

  avcc3v3-supply:
    description:
      3.3V regulator for amplifier, switch, and charge pumps.

  avcc1v8-supply:
    description:
      1.8V regulator for amplifier, switch, and charge pumps.

  clocks:
    items:
      - description: clock for master clock (MCLK)

  reset-gpios:
    maxItems: 1
    description:
      Pin used for codec hardware reset, corresponds to the RESETB pin.

  ess,max-clock-div:
    $ref: /schemas/types.yaml#/definitions/uint32
    description:
      Sets the maximum MCLK divider for generating the internal CLK.
      CLK must be at least 20x the I2C bus speed or I2C transactions
      will fail. The maximum divider should be chosen to ensure that
      CLK will not fall below the limit.
    enum:
      - 1
      - 2
      - 4
      - 8
    default: 1

  ess,oscillator-pad-bias:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: Sets the oscillator pad drive bias. 0 - full bias, 15 - disabled.
    minimum: 0
    maximum: 15
    default: 0

required:
  - compatible
  - reg
  - "#sound-dai-cells"
  - avdd-supply
  - vcca-supply
  - avcc3v3-supply
  - avcc1v8-supply
  - clocks
  - reset-gpios

unevaluatedProperties: false

examples:
  - |
    #include <dt-bindings/gpio/gpio.h>
    i2c {
        #address-cells = <1>;
        #size-cells = <0>;
        codec@48 {
            compatible = "ess,es9218p";
            reg = <0x48>;
            #sound-dai-cells = <0>;
            avdd-supply = <&avdd>;
            vcca-supply = <&vcca>;
            avcc3v3-supply = <&avcc3v3>;
            avcc1v8-supply = <&avcc1v8>;
            clocks = <&xtal_clock>;
            reset-gpios = <&gpio 1 GPIO_ACTIVE_LOW>;
        };
    };
